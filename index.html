<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>ì œì£¼ ë§›ì§‘ AR</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      overflow: hidden;
    }
    #camera-view {
      width: 100vw;
      height: 100vh;
      background: #000;
      position: relative;
    }
    .bottom-controls {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 20px;
    }
    .control-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      border: none;
      font-size: 20px;
      cursor: pointer;
    }
    .capture-btn {
      background: #ff6b6b;
      color: white;
    }
  </style>
</head>
<body>
<div id="camera-view">
  <!-- í•˜ë‹¨ ë²„íŠ¼ -->
  <div class="bottom-controls">
    <!-- ë„¤ì´í‹°ë¸Œ ARActivity ì‹¤í–‰ ë²„íŠ¼ -->
    <button id="openArBtn" class="control-btn capture-btn">ğŸ“· ì¹´ë©”ë¼</button>
    <!-- ìœ„ì¹˜ í™•ì¸ ë²„íŠ¼ -->
    <button id="locBtn" class="control-btn">ğŸ“</button>
  </div>
</div>

<!-- âœ… Capacitor ë¸Œë¦¿ì§€ -->
<script src="capacitor.js"></script>
<script>
  // ë„¤ì´í‹°ë¸Œ ArActivity ì‹¤í–‰
  document.getElementById("openArBtn")?.addEventListener("click", async () => {
    try {
      const plugin = window.Capacitor?.Plugins?.ArLauncher;
      if (!plugin) return alert("ë„¤ì´í‹°ë¸Œ í”ŒëŸ¬ê·¸ì¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      await plugin.open();
    } catch (e) {
      alert("ë„¤ì´í‹°ë¸Œ ì‹¤í–‰ ì‹¤íŒ¨: " + (e.message || e));
    }
  });

  // í˜„ì¬ ìœ„ì¹˜ í™•ì¸
  document.getElementById("locBtn")?.addEventListener("click", async () => {
    try {
      if (window.Capacitor?.Plugins?.Geolocation) {
        const pos = await window.Capacitor.Plugins.Geolocation.getCurrentPosition();
        alert(`ìœ„ì¹˜: ${pos.coords.latitude}, ${pos.coords.longitude}`);
      } else if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(
          p => alert(`ìœ„ì¹˜: ${p.coords.latitude}, ${p.coords.longitude}`),
          err => alert("ìœ„ì¹˜ ì‹¤íŒ¨: " + err.message)
        );
      } else {
        alert("ì´ í™˜ê²½ì—ì„œëŠ” ìœ„ì¹˜ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");
      }
    } catch (e) {
      alert("ìœ„ì¹˜ ì‹¤íŒ¨: " + (e.message || e));
    }
  });
</script>
<!-- âœ… Capacitor ë¸Œë¦¿ì§€: ì›ê²© ë¡œë”©(server.url)ì—ì„œë„ ì´ ê²½ë¡œëŠ” ë„¤ì´í‹°ë¸Œê°€ ê°€ì§œë¡œ ì œê³µí•´ì¤ë‹ˆë‹¤ -->
<script src="capacitor.js"></script>
<script>
  // ë¸Œë¦¿ì§€/í”ŒëŸ¬ê·¸ì¸ ë¡œë”© ìƒíƒœ ì ê²€
  (function bridgeReady() {
    const capOK = !!window.Capacitor;
    const plugins = Object.keys(window.Capacitor?.Plugins ?? {});
    console.log('[Bridge]', { capOK, plugins });
    if (!capOK) alert('capacitor.js ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
    else if (!plugins.includes('ArLauncher')) alert('ArLauncher í”ŒëŸ¬ê·¸ì¸ì´ ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.');
  })();

  // ë„¤ì´í‹°ë¸Œ ì‹¤í–‰
  document.getElementById('openArBtn')?.addEventListener('click', async () => {
    try {
      const plugin = window.Capacitor?.Plugins?.ArLauncher;
      if (!plugin) return alert('ArLauncher í”ŒëŸ¬ê·¸ì¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      const res = await plugin.open();
      console.log('ArActivity launched:', res);
    } catch (e) {
      alert('ë„¤ì´í‹°ë¸Œ ì‹¤í–‰ ì‹¤íŒ¨: ' + (e.message || e));
    }
  });
</script>


</body>

</html>
