<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <title>ì œì£¼ ë§›ì§‘ AR</title>
  <style>
    :root { color-scheme: light dark; }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }
    body { background: #111; color: #eee; }
    .container { min-height: 100%; display: grid; place-items: center; padding: 24px; }
    .card {
      width: min(680px, 92vw);
      background: #1b1b1b;
      color: #eee;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    h1 { margin: 0 0 12px; font-size: 28px; }
    p  { margin: 6px 0 14px; opacity: .85; line-height: 1.45; }

    .actions { display: flex; gap: 12px; flex-wrap: wrap; margin-top: 12px; }
    .btn {
      appearance: none; border: 0; border-radius: 28px;
      padding: 14px 18px; font-size: 16px; font-weight: 600; cursor: pointer;
      display: inline-flex; align-items: center; gap: 8px;
    }
    .btn-primary { background: #ff6b6b; color: #fff; }
    .btn-ghost   { background: #2a2a2a; color: #eaeaea; }

    .pill {
      display: inline-block; padding: 6px 10px; border-radius: 999px;
      background: #222; color: #bbb; font-size: 12px; margin-right: 6px;
    }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }

    .muted { opacity: .6; font-size: 13px; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>Capacitor Bridge Test</h1>
      <p id="envLine" class="mono pill">[Bridge] ì¤€ë¹„ì¤‘â€¦</p>

      <div class="actions">
        <!-- ë„¤ì´í‹°ë¸Œ ARActivity ì—´ê¸° -->
        <button id="openArBtn" class="btn btn-primary">ğŸ“· ë„¤ì´í‹°ë¸Œ AR ì—´ê¸°</button>

        <!-- í˜„ì¬ ìœ„ì¹˜ í‘œì‹œ(ì›¹/ë„¤ì´í‹°ë¸Œ ë‘˜ ë‹¤ í´ë°±) -->
        <button id="locBtn" class="btn btn-ghost">ğŸ“ í˜„ì¬ ìœ„ì¹˜</button>
      </div>

      <p class="muted">ë²„íŠ¼ì„ ëˆŒëŸ¬ ë„¤ì´í‹°ë¸Œ ì¹´ë©”ë¼(AR í”„ë¦¬ë·°)ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”. ë’¤ë¡œê°€ê¸°ë¥¼ ëˆ„ë¥´ë©´ ì´ í™”ë©´ìœ¼ë¡œ ëŒì•„ì˜µë‹ˆë‹¤.</p>
    </div>
  </div>

  <!-- âœ… Capacitor ë¸Œë¦¬ì§€ (ì „ì—­ window.Capacitor ì œê³µ) -->
  <script src="capacitor.js"></script>
  <script>
    // í™˜ê²½/í”ŒëŸ¬ê·¸ì¸ í‘œì‹œ
    (function showEnv() {
      const cap = window.Capacitor || {};
      const isCap = !!cap.Plugins;
      const names = isCap ? Object.keys(cap.Plugins).sort() : [];
      const line = `[Bridge] cap=${isCap} plugins=${names.join(', ') || 'none'}`;
      document.getElementById('envLine').textContent = line;
    })();

    // ë„¤ì´í‹°ë¸Œ ARActivity ì‹¤í–‰
    document.getElementById('openArBtn')?.addEventListener('click', async () => {
      try {
        const plugin = window.Capacitor?.Plugins?.ArLauncher;
        if (!plugin) return alert('ArLauncher í”ŒëŸ¬ê·¸ì¸ì´ ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.\n(MainActivity.registerPlugin, @CapacitorPlugin(name="ArLauncher") í™•ì¸)');

        const res = await plugin.open();
        console.log('ArActivity launched:', res);
      } catch (e) {
        alert('ë„¤ì´í‹°ë¸Œ ì‹¤í–‰ ì‹¤íŒ¨: ' + (e?.message || e));
      }
    });

    // í˜„ì¬ ìœ„ì¹˜ (Capacitor Geolocation â†’ ì›¹ geolocation í´ë°±)
    document.getElementById('locBtn')?.addEventListener('click', async () => {
      try {
        if (window.Capacitor?.Plugins?.Geolocation) {
          const pos = await window.Capacitor.Plugins.Geolocation.getCurrentPosition();
          alert(`ìœ„ì¹˜: ${pos.coords.latitude}, ${pos.coords.longitude}`);
          return;
        }
        if ('geolocation' in navigator) {
          navigator.geolocation.getCurrentPosition(
            p => alert(`ìœ„ì¹˜: ${p.coords.latitude}, ${p.coords.longitude}`),
            err => alert('ìœ„ì¹˜ ì‹¤íŒ¨: ' + err.message),
            { enableHighAccuracy: true, timeout: 10000 }
          );
          return;
        }
        alert('ì´ í™˜ê²½ì—ì„œëŠ” ìœ„ì¹˜ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
      } catch (e) {
        alert('ìœ„ì¹˜ ì‹¤íŒ¨: ' + (e?.message || e));
      }
    });
  </script>
  <script>
  document.addEventListener("DOMContentLoaded", () => {
    console.log("Capacitor Plugins:", window.Capacitor?.Plugins);
    alert("í”ŒëŸ¬ê·¸ì¸ ëª©ë¡: " + Object.keys(window.Capacitor?.Plugins || {}));
  });
</script>
</body>
</html>
